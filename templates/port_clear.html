<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>Port Clearance</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <!-- Favicons -->
  <link href="/static/img/logo.jpg" rel="icon">

  <!-- Google Fonts -->
  <link href="https://fonts.gstatic.com" rel="preconnect">
  <link
    href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Nunito:300,300i,400,400i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i"
    rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="/static/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="/static/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="/static/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
  <link href="/static/vendor/quill/quill.snow.css" rel="stylesheet">
  <link href="/static/vendor/quill/quill.bubble.css" rel="stylesheet">
  <link href="/static/vendor/remixicon/remixicon.css" rel="stylesheet">
  <link href="/static/vendor/simple-datatables/style.css" rel="stylesheet">

  <!-- Template Main CSS File -->
  <link href="/static/css/style.css" rel="stylesheet">


</head>

<body>

  <!-- ======= Header ======= -->
  <header id="header" class="header fixed-top d-flex align-items-center">

    <div class="d-flex align-items-center justify-content-between">
      <a href="/" class="logo d-flex align-items-center">
        <img src="/static/img/logo.jpg" alt="">

      </a>
      <i class="bi bi-list toggle-sidebar-btn" onclick="changeStyleOnClick()"></i>
    </div><!-- End Logo -->


    <nav class="header-nav ms-auto">
      <ul class="d-flex align-items-center">



        <li class="nav-item dropdown pe-3">

          <a class="nav-link nav-profile d-flex align-items-center pe-0" href="#" data-bs-toggle="dropdown">
            <img src="/static/img/human-icon.png" alt="Profile" class="rounded-circle">
            <span class="d-none d-md-block dropdown-toggle ps-2">Admin</span>
          </a><!-- End Profile Iamge Icon -->

          <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow profile">
            <li class="dropdown-header">
              <h6>Admin</h6>
              <span>Founder</span>
            </li>
            <li>
              <hr class="dropdown-divider">
            </li>


          </ul><!-- End Profile Dropdown Items -->
        </li><!-- End Profile Nav -->

      </ul>
    </nav><!-- End Icons Navigation -->

  </header><!-- End Header -->

  <!-- ======= Sidebar ======= -->
  <aside id="sidebar" class="sidebar">

    <ul class="sidebar-nav" id="sidebar-nav">

      <li class="nav-item">
        <a class="nav-link " href="/" style="background-color: #fff;color: #012970">
          <i class="bi bi-grid" style="color: #899bbd;"></i>
          <span>Dashboard</span>
        </a>
      </li><!-- End Dashboard Nav -->



      <li class="nav-item">
        <a class="nav-link collapsed" data-bs-target="#forms-nav" data-bs-toggle="collapse" href="#" style="color: #4154f1;
        background: #f6f9ff;">
          <i class="bi bi-journal-text" style="color:#4154f1"></i><span>Forms</span><i
            class="bi bi-chevron-down ms-auto"></i>
        </a>
        <ul id="forms-nav" class="nav-content collapse " data-bs-parent="#sidebar-nav">
          <li>
            <a href="/shipentry">
              <i class="bi bi-circle"></i><span>Shipment entry</span>
            </a>
          </li>
          <li>
            <a href="/adpay">
              <i class="bi bi-circle"></i><span>Advance Payment</span>
            </a>
          </li>
          <li>
            <a href="/shipdoc">
              <i class="bi bi-circle"></i><span>Shipment documents</span>
            </a>
          </li>
          <li>
            <a href="/portclear">
              <i class="bi bi-circle"></i><span>Port Clearance</span>
            </a>
          </li>
        </ul>
      </li><!-- End Forms Nav -->

      <li class="nav-item">
        <a class="nav-link collapsed" data-bs-target="#tables-nav" data-bs-toggle="collapse" href="#">
          <i class="bi bi-file-earmark"></i><span>Reports</span><i class="bi bi-chevron-down ms-auto"></i>
        </a>
        <ul id="tables-nav" class="nav-content collapse " data-bs-parent="#sidebar-nav">
          <li>
            <a href="/advpaid">
              <i class="bi bi-circle"></i><span>Advance paid</span>
            </a>
          </li>
          <li>
            <a href="/advpen">
              <i class="bi bi-circle"></i><span>Advance pending</span>
            </a>
          </li>
          <li>
            <a href="/intransit">
              <i class="bi bi-circle"></i><span>In transit</span>
            </a>
          </li>
          <li>
            <a href="/notshipped">
              <i class="bi bi-circle"></i><span>Yet to be shipped</span>
            </a>
          </li>
          <li>
            <a href="/ETA_ship">
              <i class="bi bi-circle"></i><span>ETA of shipments</span>
            </a>
          </li>
          <li>
            <a href="/mat_wise_ship">
              <i class="bi bi-circle"></i><span>Material Wise Shipments</span>
            </a>
          </li>
          <li>
            <a href="/month_ship">
              <i class="bi bi-circle"></i><span>Monthly Shipment Report</span>
            </a>
          </li>
          <li>
            <a href="/month_item">
              <i class="bi bi-circle"></i><span>Monthly Item Wise Report</span>
            </a>
          </li>
          <li>
            <a href="/LPR_month">
              <i class="bi bi-circle"></i><span>Landed Price reports</span>
            </a>
          </li>
        </ul>
      </li><!-- End Reports Nav -->

      <!-- ---Masters nav---- -->
      <li class="nav-item">
        <a class="nav-link collapsed" data-bs-target="#master-nav" data-bs-toggle="collapse" href="#">
          <i class="bi bi-journal-text"></i><span>Master</span><i class="bi bi-chevron-down ms-auto"></i>
        </a>
        <ul id="master-nav" class="nav-content collapse " data-bs-parent="#sidebar-nav">
          <li>
            <a href="/suppliermaster">
              <i class="bi bi-circle"></i><span>Supplier</span>
            </a>
          </li>
          <li>
            <a href="/indentormaster">
              <i class="bi bi-circle"></i><span>Indentor</span>
            </a>
          </li>
          <li>
            <a href="/materialmaster">
              <i class="bi bi-circle"></i><span>Material</span>
            </a>
          </li>
          <li>
            <a href="/shiplinemaster">
              <i class="bi bi-circle"></i><span>Shipping Line</span>
            </a>
          </li>
        </ul>
      </li>

      <!-- ---Masters nav end ---- -->

    </ul>

  </aside><!-- End Sidebar-->

  <main id="main" class="main">

    <h1 style="text-align: center;margin-top: 20px;color: #032C73;font-weight: bold;">PORT CLEARANCE</h1>
    <form class="mx-auto shipforms" action="/port_clear_data" method="post" enctype="multipart/form-data">
      <div class="row">
        <div class="col-lg-4 col-md-12 col-sm-12 mx-auto">
          <div class="form-group">
            <label for="pono">PONO</label>
            <input type="text" pattern="^[A-Za-z0-9\/\-]*$" min="0" required class="form-control" id="pono" name="pono">
          </div>
        </div>
        <div class="col-lg-4 col-md-6 col-sm-12 mx-auto">
          <div class="form-group">
            <label for="Invoiceno">Invoice no </label>
            <input type="text" pattern="^[A-Za-z0-9\/\-]*$" min="0" required class="form-control" id="invno"
              name="invno">
          </div>
        </div>
        <div class="col-lg-4 col-md-6 col-sm-12 mx-auto">
          <div class="form-group">
            <label for="InvoiceAmt">Invoice Amount<b style="color: blue;">*</b></label>
            <input type="number" min="0" required class="form-control" id="invamt" name="invamt">
          </div>
        </div>
        <div class="col-lg-3 col-md-6 col-sm-12 mx-auto">
          <div class="form-group">
            <label for="InvoiceAmt">Exchange rate to INR</label>
            <input type="number" min="0" required class="form-control" id="exrate" name="exrate">
          </div>
        </div>
        <div class="col-lg-3 col-md-6 col-sm-12 mx-auto">
          <div class="form-group">
            <button type="button" class="btn conversionbutton" onclick="total1()">=</i></button>
          </div>
        </div>


        <div class="col-lg-3 col-md-6 col-sm-12 mx-auto">
          <div class="form-group">
            <label for="InvoiceAmt">Inv Amount in INR<b style="color: blue;">*</b></label>
            <input type="number" min="0" required class="form-control" id="invinr" name="invinr">
          </div>
        </div>
        <div class="col-lg-3 col-md-12 col-sm-12 mx-auto">
          <div class="form-group">
            <label for="blno">BLNO</label>
            <input type="text" pattern="^[A-Za-z0-9\/\-]*$" min="0" required class="form-control" id="blno" name="blno">
          </div>
        </div>
        <div class="col-lg-4 col-md-12 col-sm-12 mx-auto">
          <div class="form-group">
            <label for="ShippingExpenses">Shipping Expenses</label>
            <input type="number" min="0" required class="form-control" id="shipexp" name="shipexp">
          </div>
        </div>
        <div class="col-lg-4 col-md-12 col-sm-12 mx-auto">
          <div class="form-group">
            <label for="CHAExpenses">CHA Expenses</label>
            <input type="number" min="0" required class="form-control" id="chaexp" name="chaexp">
          </div>
        </div>
        <div class="col-lg-4 col-md-12 col-sm-12 mx-auto">
          <div class="form-group">
            <label for="DutyPaid">Duty paid</label>
            <input type="number" min="0" required class="form-control" id="dutypaid" name="dutypaid">
          </div>

        </div>
        <div class="col-lg-4 col-md-12 col-sm-12 mx-auto">
          <div class="form-group">
            <label for="MissExpeness">Miss Expeness</label>
            <input type="number" min="0" required class="form-control" id="missexp" name="missexp">
          </div>

        </div>
        <div class="col-lg-4 col-md-12 col-sm-12 mx-auto">
          <div class="form-group">
            <label for="PortExpensess">Port Expensess</label>
            <input type="number" min="0" required class="form-control" id="portexp" name="portexp">
          </div>

        </div>
        <div class="col-lg-4 col-md-12 col-sm-12 mx-auto">
          <div class="form-group">
            <label for="Transport">Transport</label>
            <input type="number" min="0" required class="form-control" id="transport" name="transport">
          </div>

        </div>
      </div>
      <div class="row">
        <div class="col-lg-8 col-md-12 col-sm-12 mx-auto">
          <div class="form-group">
            <label for="Detention">Detention if Any</label>
            <input type="number" min="0" required class="form-control" id="detention" name="detention">
          </div>

        </div>
        <div class="col-lg-4 col-md-12 col-sm-12 mx-auto">
          <div class="form-group">
            <label for="ISD" style="width: 197px;">Insurance & Stamp Duty</label>
            <input type="number" min="0" required class="form-control" id="instampduty" name="instampduty">
          </div>

        </div>
      </div>
      <div class="row">
        <div class="col-lg-4 col-md-12 col-sm-12 mx-auto">
          <div class="form-group">
            <label for="BankCharges">Bank Charges</label>
            <input type="number" min="0" required class="form-control" id="bankchg" name="bankchg">
          </div>

        </div>
        <div class="col-lg-4 col-md-12 col-sm-12 mx-auto">
          <div class="form-group">
            <label for="LoadedPrice">Landed Price<b style="color: blue;">*</b></label>
            <input type="number" min="0" required class="form-control" id="loadedprice" name="loadedprice">
          </div>

        </div>
        <div class="col-lg-4 col-md-12 col-sm-12 mx-auto">
          <div class="form-group">
            <label for="ClearanceDate">Clearance Date</label>
            <input type="date" class="form-control" id="ClearanceDate" name="ClearanceDate" placeholder="DD/MM/YYYY"
              required>
          </div>

        </div>

      </div>



      <div class="submit-btn" style="text-align: center;">
        <button type="submit" class="btn btn-primary">CLEAR SHIPMENT</button>
      </div><br>
      <div class="submit-btn" style="text-align: center;">
        <button type="button" class="btn btn-primary" onclick="fetchLP();fetchinvamt();fetchExpenses()">FETCH DETAILS</button>
      </div>

    </form>



  </main><!-- End #main -->

  <!-- ======= Footer ======= -->
  <footer id="footer" class="footer">
    <div class="copyright">
      &copy; Copyright <strong><span>Metal Care Alloys</span></strong>. All Rights Reserved
    </div>
    <div class="credits">

      Developed by <a href="#">Pods Technology Solutions</a>
    </div>
  </footer><!-- End Footer -->

  <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i
      class="bi bi-arrow-up-short"></i></a>

  <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

  <script>

    function fetchLP() {

      console.log("yashh")
      var blno = document.getElementById('blno').value;

      // Perform an AJAX request to fetch the pending amount
      $.ajax({
        type: "POST",
        url: "/fetch_LP",
        data: { 'blno': blno },
        success: function (response) {
          console.log(response);
          // var amount = parseFloat(response[0].amount);
          var qty = parseFloat(response[1].quantity);
          var invinr = parseFloat(document.getElementById('invinr').value);
          var shipexp = parseFloat(document.getElementById('shipexp').value);
          var chaexp = parseFloat(document.getElementById('chaexp').value);
          var dutypaid = parseFloat(document.getElementById('dutypaid').value);
          var missexp = parseFloat(document.getElementById('missexp').value);
          var portexp = parseFloat(document.getElementById('portexp').value);
          var transport = parseFloat(document.getElementById('transport').value);
          var instampduty = parseFloat(document.getElementById('instampduty').value);
          var BankCharges = parseFloat(document.getElementById('bankchg').value);
          var detention = parseFloat(document.getElementById('detention').value);
          // console.log(amount)///////////
          console.log(qty)
          console.log(invinr)
          console.log(shipexp)
          console.log(chaexp)
          console.log(dutypaid)
          console.log(missexp)
          console.log(portexp)
          console.log(transport)
          console.log(instampduty)
          console.log(detention)
          console.log(BankCharges)


          loadingprice = (invinr + shipexp + chaexp + dutypaid + missexp + portexp + transport + instampduty + BankCharges + detention) / qty;

          document.getElementById('loadedprice').value = loadingprice;

        },
        error: function (error) {
          console.log(error);
        }
      });


    }

    function fetchinvamt() {

console.log("yashh")
var blno = document.getElementById('blno').value;

// Perform an AJAX request to fetch the pending amount
$.ajax({
  type: "POST",
  url: "/fetch_invamt",
  data: { 'blno': blno },
  success: function (response) {
    console.log(response);


    document.getElementById('invamt').value = response.invoiceAmount;

  },
  error: function (error) {
    console.log(error);
  }
});

}

function fetchExpenses() {
    console.log("Fetching expenses...");
    var pono = document.getElementById('pono').value;

    // Perform an AJAX request to fetch the expenses
    $.ajax({
        type: "POST",
        url: "/fetch_expenses",
        data: { 'pono': pono },
        success: function (response) {
            console.log(response);

            
            if (response.shipexp !== null) {
                document.getElementById('shipexp').value = response.shipexp;
            }
            if (response.chaexp !== null) {
                document.getElementById('chaexp').value = response.chaexp;
            }
            if (response.missexp !== null) {
                document.getElementById('missexp').value = response.missexp;
            }
            if (response.portexp !== null) {
                document.getElementById('portexp').value = response.portexp;
            }
            if (response.transport !== null) {
                document.getElementById('transport').value = response.transport;
            }
            if (response.detention !== null) {
                document.getElementById('detention').value = response.detention;
            }
            if (response.instampduty !== null) {
                document.getElementById('instampduty').value = response.instampduty;
            }
            if (response.bankchg !== null) {
                document.getElementById('bankchg').value = response.bankchg;
            }
            
        },
        error: function (error) {
            console.log(error);
        }
    });
}
  </script>
  <script>
    function total1() {
      console.log("hello");
      let invamt = document.getElementById('invamt').value;
      let exrate = document.getElementById('exrate').value;
      console.log(invamt * exrate)
      document.getElementById('invinr').value = (invamt * exrate).toFixed(2);
    }
  </script>
  <!-- Vendor JS Files -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
    crossorigin="anonymous"></script>
  <script src="/static/vendor/apexcharts/apexcharts.min.js"></script>
  <script src="/static/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="/static/vendor/chart.js/chart.umd.js"></script>
  <script src="/static/vendor/echarts/echarts.min.js"></script>
  <script src="/static/vendor/quill/quill.min.js"></script>
  <script src="/static/vendor/simple-datatables/simple-datatables.js"></script>
  <script src="/static/vendor/tinymce/tinymce.min.js"></script>
  <script src="/static/vendor/php-email-form/validate.js"></script>

  <!-- Template Main JS File -->
  <script src="/static/js/main.js"></script>

</body>

</html>